<div class="map-wrapper">
  <!-- Panneau de statistiques -->
  <div class="stats-panel">
    <h3>Statistiques</h3>
    <div class="stats-grid">
      <div class="stat-item stat-total">
        <div class="stat-label">Contribuables</div>
        <div class="stat-value">{{ formatNumber(totalContribuables) }}</div>
      </div>
      <div class="stat-item stat-success">
        <div class="stat-label">Payés</div>
        <div class="stat-value">{{ formatNumber(payes) }}</div>
      </div>
      <div class="stat-item stat-warning">
        <div class="stat-label">Partiels</div>
        <div class="stat-value">{{ formatNumber(partiels) }}</div>
      </div>
      <div class="stat-item stat-danger">
        <div class="stat-label">Non payés</div>
        <div class="stat-value">{{ formatNumber(nonPayes) }}</div>
      </div>
      <div class="stat-item stat-info">
        <div class="stat-label">Taux de paiement</div>
        <div class="stat-value">{{ tauxPaiement }}%</div>
      </div>
      <div class="stat-item stat-collecte">
        <div class="stat-label">Total espéré</div>
        <div class="stat-value">{{ formatCurrency(montantCollecteTotal) }}</div>
      </div>
      <div class="stat-item stat-collectes">
        <div class="stat-label">Nombre de collectes</div>
        <div class="stat-value">{{ formatNumber(nombreCollectesTotal) }}</div>
      </div>
      <div class="stat-item stat-ticket">
        <div class="stat-label">Ticket moyen</div>
        <div class="stat-value">{{ formatCurrency(ticketMoyen) }}</div>
      </div>
    </div>
  </div>

  <!-- Légende -->
  <div class="legend-panel">
    <h4>Légende</h4>
    <div class="legend-items">
      <div class="legend-item">
        <div class="legend-marker marker-paye"></div>
        <span>Contribuable payé</span>
      </div>
      <div class="legend-item">
        <div class="legend-marker marker-partiel"></div>
        <span>Contribuable partiel</span>
      </div>
      <div class="legend-item">
        <div class="legend-marker marker-non-paye"></div>
        <span>Contribuable non payé</span>
      </div>
    </div>
  </div>

  <!-- Carte -->
  <div id="map" class="map-container"></div>

  <!-- Loading -->
  @if (loading) {
    <div class="loading-overlay">
      <div class="spinner"></div>
      <p>Chargement des données...</p>
    </div>
  }
</div>
